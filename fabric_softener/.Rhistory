barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeLR==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeXL==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formS==1])))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formB==1])))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formF==1])))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formL==1])))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formS==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formB==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formF==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formL==1])),ylim=c(0,0.1))
par(mfrow=c(1,1))
barplot(prop.table(table(finaldata$display)))
barplot(prop.table(table(finaldata$feature)))
barplot(prop.table(table(finaldata$d_disp)))
barplot(prop.table(table(finaldata$d_feat)))
barplot(prop.table(table(finaldata$ARSP)))
barplot(prop.table(table(finaldata$price_paid)))
barplot(prop.table(table(finaldata$ARSP)))
barplot(prop.table(table(finaldata$price_paid)))
barplot(prop.table(table(finaldata$regular_price)))
barplot(prop.table(table(finaldata$price_cut)))
par(msrow=c(2,2))
par(msrow=c(2,2))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$ARSP)),ylim=c(0,0.2))
barplot(prop.table(table(finaldata$price_paid)),ylim=c(0,0.2))
barplot(prop.table(table(finaldata$regular_price)),ylim=c(0,0.2))
barplot(prop.table(table(finaldata$price_cut)),ylim=c(0,0.2))
hist(finaldatav1$HH_id,breaks = 500)
par(mfrow=c(1,1))
hist(finaldatav1$HH_id,breaks = 500)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeSM==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeMD==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeLR==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeXL==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeSM==1])),ylim=c(0,0.1), main = "Size = Small")
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeSM==1])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeMD==1])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeLR==1])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeXL==1])),ylim=c(0,0.1), main = "X-Large")
barplot(prop.table(table(finaldata$IRIweek[finaldata$formS==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formB==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formF==1])),ylim=c(0,0.1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$formL==1])),ylim=c(0,0.1))
par(mfrow=c(1,1))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeLR==1])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldata$IRIweek[finaldata$formF==1])),ylim=c(0,0.1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeSM==1])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeMD==1])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeLR==1])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldata$IRIweek[finaldata$sizeXL==1])),ylim=c(0,0.1), main = "X-Large")
IRIdates_months_seasons <- read.csv("~/Studies/Courses/USF/Statistical Data Mining/Final Project/fabric_softener/IRIdates_months_seasons.csv")
View(IRIdates_months_seasons)
finaldatav2 <- merge(finaldatav1,IRIdates_months_seasons,by=("IRIweek"))
View(finaldatav2)
barplot(prop.table(table(finaldatav2$Season[finaldatav2$sizeSM==1 & finaldatav2$Season==summer])),ylim=c(0,0.1), main = "Small")
par(mfrow=c(2,2))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$Season[finaldatav2$sizeSM==1 & finaldatav2$Season==summer])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season==summer])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season==summer])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldatav2$Season[finaldatav2$sizeSM==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$Season[finaldatav2$sizeSM==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Large")
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$Season[finaldatav2$sizeSM==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Medium")
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeSM==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeXL==1 & finaldatav2$Season=="Summer"])),ylim=c(0,0.1), main = "X-Large")
hist(finaldatav1$HH_id,breaks = 500)
hist(finaldatav2$HH_id[finaldatav2$Season=="Summer"])
IRIdates_months_seasons <- read.csv("IRIdates_months_seasons.csv")
finaldatav2 <- merge(finaldatav1,IRIdates_months_seasons,by=("IRIweek"))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"])
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"])
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"])
hist(finaldatav2$HH_id[finaldatav2$Season=="autum"])
par(mfrow=c(2,2))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"])
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"])
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"])
hist(finaldatav2$HH_id[finaldatav2$Season=="autum"])
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"])
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = 250)
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = 300)
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300))
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300))
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300))
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300))
par(mfrow=c(2,2))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300))
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300))
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300))
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300))
par(mfrow=c(2,2))
par(mfrow=c(2,2))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300), main="Winter")
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300), main="Spring")
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300), main="Summer")
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300), main="Autumn")
par(mfrow=c(1,1))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300), main="Winter", xlab = "House ID", col = "Blue")
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300), main="Winter", xlab = "House ID", col = "Light Blue")
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300), main="Spring", xlab = "House ID", col = "light green")
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300), main="Summer", xlab = "House ID", col = "light orange")
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300), main="Summer", xlab = "House ID", col = "orange")
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300), main="Autumn", xlab = "House ID", col = "brown")
par(mfrow=c(2,2))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300), main="Winter", xlab = "House ID", col = "Light Blue")
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300), main="Spring", xlab = "House ID", col = "light green")
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300), main="Summer", xlab = "House ID", col = "orange")
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300), main="Autumn", xlab = "House ID", col = "brown")
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeSM==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeXL==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "X-Large")
par(mfrow=c(1,1))
par(mfrow=c(2,2))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300), main="Winter", xlab = "House ID", col = "Light Blue")
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300), main="Spring", xlab = "House ID", col = "light green")
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300), main="Summer", xlab = "House ID", col = "orange")
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300), main="Autumn", xlab = "House ID", col = "brown")
par(mfrow=c(1,1))
table(finaldatav2$Season,finaldata$size)
table(finaldatav2$Season,finaldata$form)
table(finaldatav2$Season,as.factor(finaldata$`SKU#`))
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="winter"])))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="spring"])))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="summer"])))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="autumn"])))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="winter"])), main="Winter", xlab = "House ID", col = "Light Blue")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="spring"])), main="Spring", xlab = "House ID", col = "light green")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="summer"])), main="Summer", xlab = "House ID", col = "orange")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "House ID", col = "brown")
par(mfrow=c(1,1))
par(mfrow=c(3,4))
for (i in 1:12) {
barplot(prop.table(table(finaldata$brand[finaldatav2$Month==i])), main=i, xlab = "Brand")
}
par(mfrow=c(1,1))
table(finaldatav2$Season,finaldatav2$d_disp)
table(finaldatav2$Season,finaldatav2$d_feat)
plot(finaldatav2$price_cut,finaldatav2$regular_price)
cor((finaldatav2$price_cut,finaldatav2$regular_price))
cor(finaldatav2$price_cut,finaldatav2$regular_price)
plot(log(finaldatav2$price_cut),finaldatav2$regular_price)
cor(log(finaldatav2$price_cut),finaldatav2$regular_price)
plot(finaldatav2$price_cut,log(finaldatav2$regular_price))
plot(log(finaldatav2$price_cut),log(finaldatav2$regular_price))
plot(log(finaldatav2$price_cut),finaldatav2$regular_price)
plot(log(finaldatav2$price_cut),log(finaldatav2$regular_price))
plot(finaldatav2$price_cut,finaldatav2$regular_price) # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = h) # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "h") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "s") # other than no price cut, There is a positive relationship between the two
par(mfrow=c(1,1))
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "s") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price) # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "o") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "o") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "s") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "h") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "l") # other than no price cut, There is a positive relationship between the two
plot(finaldatav2$price_cut,finaldatav2$regular_price,type = "p") # other than no price cut, There is a positive relationship between the two
plot(log(finaldatav2$price_cut),log(finaldatav2$regular_price)) # looks the best fit
# Sale of Brands by Month
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(3,4))
for (i in 1:12) {
barplot(prop.table(table(finaldata$brand[finaldatav2$Month==i])), main=i, xlab = "Brand")
}
par(mfrow=c(1,1))
# Sale of Brands by Season
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown")
par(mfrow=c(1,1)) #Clear distinction of choice of SKU in different seasons
plot(finaldatav2$price_cut,finaldatav2$regular_price) # other than no price cut, There is a positive relationship between the two
cor(finaldatav2)
View(finaldata)
finaldatav3 <- merge(finaldatav2,finaldata[,c(4,5,6,7)])
finaldatav3 <- finaldatav2
View(finaldatav2)
View(finaldatav3)
finaldatav3[,37] <- finaldata[,4]
finaldatav3[,38] <- finaldata[,5]
finaldatav3[,39] <- finaldata[,6]
finaldatav3[,40] <- finaldata[,7]
names(finaldatav3)
names(finaldatav3[,37:40])
View(finaldata)
names(finaldatav3[,37:40]) <- c("brand", "from", "formula", "size")
names(finaldatav3)
colnames(finaldatav3[,37:40]) <- c("brand", "from", "formula", "size")
names(finaldatav3)
colnames(finaldatav3)
colnames(finaldatav3[,c(37,38,39,40)])
colnames(finaldatav3[,c(37,38,39,40)]) <- c("brand", "from", "formula", "size")
colnames(finaldatav3)
colnames(finaldatav3)[colnames(finaldatav3)=="V37"] <- "brand"
View(finaldatav3)
View(finaldata)
colnames(finaldatav3)[colnames(finaldatav3)=="V38"] <- "form"
colnames(finaldatav3)[colnames(finaldatav3)=="V39"] <- "formula"
colnames(finaldatav3)[colnames(finaldatav3)=="V40"] <- "size"
table(finaldatav3$Season,finaldatav3$size)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue")
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green")
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange")
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown")
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,1))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,1))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,1))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,1))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.8))
plot(finaldatav2$price_cut,finaldatav2$regular_price, pch=19,cex=0.5, col=as.character(finaldatav3$size)) # other than no price cut, There is a positive relationship between the two
View(finaldatav3)
plot(finaldatav2$price_cut,finaldatav2$regular_price, pch=19,cex=0.5, col=finaldatav3$size) # other than no price cut, There is a positive relationship between the two
par(mfrow=c(1,1)) #Sales of fabric softner go up in winter and spring months. Highest in Spring
plot(finaldatav2$price_cut,finaldatav2$regular_price, pch=19,cex=0.5, col=finaldatav3$size)
plot(finaldatav2$price_cut,finaldatav2$regular_price, cex=0.5, col=finaldatav3$size)
plot(finaldatav2$price_cut,finaldatav2$regular_price, col=finaldatav3$size)
hist(finaldatav3$price_cut[finaldatav3$Season=="winter"], ylim = c(0,3.300), main="Winter", xlab = "House ID", col = "Light Blue")
par(mfrow=c(2,2))
hist(finaldatav3$price_cut[finaldatav3$Season=="winter"], main="Winter", xlab = "Price Cut", col = "Light Blue")
hist(finaldatav3$price_cut[finaldatav3$Season=="spring"],  main="Spring", xlab = "Price Cut", col = "light green")
hist(finaldatav3$price_cut[finaldatav3$Season=="summer"], main="Summer", xlab = "Price Cut", col = "orange")
hist(finaldatav3$price_cut[finaldatav3$Season=="autumn"],  main="Autumn", xlab = "Price Cut", col = "brown")
par(mfrow=c(1,1))
hist(finaldatav3$price_cut[finaldatav3$Season=="spring"],  main="Spring", xlab = "Price Cut", col = "light green")
par(mfrow=c(2,2))
hist(finaldatav3$price_cut[finaldatav3$Season=="winter"], ylim = c(0,1500), main="Winter", xlab = "Price Cut", col = "Light Blue")
hist(finaldatav3$price_cut[finaldatav3$Season=="spring"], ylim = c(0,1500), main="Spring", xlab = "Price Cut", col = "light green")
hist(finaldatav3$price_cut[finaldatav3$Season=="summer"], ylim = c(0,1500),main="Summer", xlab = "Price Cut", col = "orange")
hist(finaldatav3$price_cut[finaldatav3$Season=="autumn"], ylim = c(0,1500), main="Autumn", xlab = "Price Cut", col = "brown")
par(mfrow=c(1,1))
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(3,4))
for (i in 1:12) {
barplot(prop.table(table(finaldata$brand[finaldatav2$Month==i])), main=i, xlab = "Brand")
}
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown")
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeSM==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeXL==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "X-Large")
par(mfrow=c(1,1))
table(finaldatav2$Season,finaldata$form)
table(finaldatav2$Season,finaldata$size)
table(finaldatav2$Season,as.factor(finaldata$`SKU#`))
table(finaldatav3$Season,finaldatav3$`SKU#`)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata3$`SKU#`[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.8))
barplot(prop.table(table(finaldata3$`SKU#`[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.8))
barplot(prop.table(table(finaldata3$`SKU#`[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.8))
barplot(prop.table(table(finaldata3$`SKU#`[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.8))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.8))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.8))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.8))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.8))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.1))
par(mfrow=c(1,1))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = finaldatav3$price_cut)
barplot(prop.table(table(finaldatav3$`SKU#`)),col = as.factor(finaldatav3$price_cut))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = as.numeric(finaldatav3$price_cut))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = finaldatav3$ARSP))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = finaldatav3$ARSP)
barplot(prop.table(table(finaldatav3$`SKU#`)),col = heat.colors(10))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = heat.colors(20))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = heat.colors(5))
barplot(prop.table(table(finaldatav3$`SKU#`)),col = heat.colors(20))
barplot(prop.table(table(finaldatav3$`SKU#`)), col = c(18:24))
plot(prop.table(table(finaldatav3$`SKU#`)), finaldatav3$ARSP)
barplot(prop.table(table(finaldatav3$`SKU#`)))
lines(finaldatav3$ARSP)
barplot(prop.table(table(finaldatav3$`SKU#`)))
lines(finaldatav3$ARSP)
points(finaldatav3$ARSP)
plot(finaldatav3$`SKU#`,finaldatav3$ARSP)
View(finaldatav3)
plot(finaldatav3$`SKU#`,finaldatav3$ARSP, col = finaldatav3$size)
plot(finaldatav3$`SKU#`,finaldatav3$ARSP, col = finaldatav3$size, pch =19)
plot(finaldatav3$`SKU#`,finaldatav3$ARSP, col = finaldatav3$size, pch =19, las=2)
with(finaldatav3[finaldatav3$size=="SM",],plot(finaldatav3$`SKU#`,finaldatav3$ARSP) )
with(finaldatav3[finaldatav3$size=="XL",],plot(finaldatav3$`SKU#`,finaldatav3$ARSP) )
plot(finaldatav3$`SKU#`[finaldatav3$size=="XL"],finaldatav3$ARSP[finaldatav3$size=="XL",])
plot(finaldatav3$`SKU#`[finaldatav3$size=="XL"],finaldatav3$ARSP[finaldatav3$size=="XL"])
plot(finaldatav3$`SKU#`[finaldatav3$size=="SM"],finaldatav3$ARSP[finaldatav3$size=="SM"])
plot(finaldatav3$`SKU#`[finaldatav3$size=="LG"],finaldatav3$ARSP[finaldatav3$size=="LG"])
plot(finaldatav3$`SKU#`[finaldatav3$size=="MD"],finaldatav3$ARSP[finaldatav3$size=="MD"])
write.csv(finaldatav3,"finaldatav3.csv",row.names = F)
hist(finaldatav3$Month)
barplot(finaldatav3$Month)
hist(finaldatav3$Month, breaks = 12)
hist(finaldatav3$Month, breaks = 13)
hist(finaldatav3$Month, breaks = 14)
plot(finaldatav3$Month)
hist(finaldatav3$Month)
hist(finaldatav3$Season)
barplot(finaldatav3$Season,finaldatav3$IRIweek)
barplot(prop.table(table(finaldatav3$Season)))
barplot(prop.table(table(finaldatav3$Month)))
barplot(prop.table(table(finaldatav3$Season)))
barplot(prop.table(table(finaldatav3$Month)))
barplot(prop.table(table(finaldatav3$Season)))
barplot(prop.table(table(finaldatav3$Month)))
barplot(prop.table(table(finaldatav3$Season)))
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeSM==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeXL==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "X-Large")
par(mfrow=c(1,1))
# Sale of Brands by Season
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown")
par(mfrow=c(1,1))
#Clear distinction of choice of brand in different seasons
# Sale of Brands by Month
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(3,4))
for (i in 1:12) {
barplot(prop.table(table(finaldata$brand[finaldatav2$Month==i])), main=i, xlab = "Brand")
}
par(mfrow=c(1,1))
# No clear pattern
table(finaldatav3$Season,finaldatav3$size)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.8))
par(mfrow=c(1,1))
# Price cut by Season
par(mfrow=c(2,2))
hist(finaldatav3$price_cut[finaldatav3$Season=="winter"], ylim = c(0,1500), main="Winter", xlab = "Price Cut", col = "Light Blue")
hist(finaldatav3$price_cut[finaldatav3$Season=="spring"], ylim = c(0,1500), main="Spring", xlab = "Price Cut", col = "light green")
hist(finaldatav3$price_cut[finaldatav3$Season=="summer"], ylim = c(0,1500),main="Summer", xlab = "Price Cut", col = "orange")
hist(finaldatav3$price_cut[finaldatav3$Season=="autumn"], ylim = c(0,1500), main="Autumn", xlab = "Price Cut", col = "brown")
par(mfrow=c(1,1))
barplot(prop.table(table(finaldatav3$Season)))
table(finaldatav3$Season,finaldatav3$`SKU#`)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.1))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
hist(finaldatav2$HH_id[finaldatav2$Season=="winter"], ylim = c(0,300), main="Winter", xlab = "House ID", col = "Light Blue")
hist(finaldatav2$HH_id[finaldatav2$Season=="spring"], ylim = c(0,300), main="Spring", xlab = "House ID", col = "light green")
hist(finaldatav2$HH_id[finaldatav2$Season=="summer"], ylim = c(0,300), main="Summer", xlab = "House ID", col = "orange")
hist(finaldatav2$HH_id[finaldatav2$Season=="autumn"], ylim = c(0,300), main="Autumn", xlab = "House ID", col = "brown")
par(mfrow=c(1,1))
finaldatav3 <- read.csv("~/Studies/Courses/USF/Statistical Data Mining/Final Project/fabric_softener/finaldatav3.csv")
View(finaldatav3)
train <- finaldatav3[1:4419,]
View(train)
train <- finaldatav3[1:4417,]
View(finaldatav3)
test <- finaldatav3[4418:6554,]
View(train)
View(test)
glm1 <- glm(SKU.~., data = train, family = "binomial")
glm1 <- glm(as.factor(SKU.)~., data = train, family = "binomial")
summary(glm1)
glm1 <- glm(as.factor(SKU.) ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + regular_price + price_paid +
price_cut, data = train, family = "binomial")
summary(glm1)
glm1 <- lm(as.factor(SKU.) ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + regular_price + price_paid +
price_cut, data = train, family = "binomial")
summary(glm1)
glm1 <- lm(as.factor(SKU.) ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + regular_price + price_paid +
price_cut, data = train)
summary(glm1)
glm1
glm1 <- lm(SKU. ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + regular_price + price_paid +
price_cut, data = train)
summary(glm1)
glm1 <- lm(SKU. ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + as.numeric(regular_price) + as.numeric(price_paid) +
as.numeric(price_cut), data = train)
summary(glm1)
plot(glm1)
as.factor(finaldatav3$SKU.)
library(tree)
library("tree")
library("party")
as.numeric(price_cut), data = train)
glm1 <- lm(SKU. ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + as.numeric(regular_price) + as.numeric(price_paid) +as.numeric(price_cut), data = train)
summary(glm1)
ctree1 <- ctree(as.factor(SKU.) ~ as.factor(HH_id) + as.factor(Month) + as.factor(Season) +
as.factor(brand) + as.factor(form) + as.factor(formula) + as.factor(size) +
as.factor(display)  + as.factor(feature) + as.numeric(regular_price) + as.numeric(price_paid) +as.numeric(price_cut), data = train)
View(finaldatav2)
View(finaldata)
finaldatav2 <- merge(finaldatav1,IRIdates_months_seasons,by=("IRIweek"))
finaldatav3 <- merge(finaldatav2,finaldata[,c(4,5,6,7)])
finaldatav2 <- merge(finaldatav1,IRIdates_months_seasons,by=("IRIweek"))
View(finaldatav2)
finaldatav3 <- finaldatav2
View(finaldata)
View(finaldata)
finaldatav1 <- finaldata[,c(-2,,-7,-31,-33,-35,-37)]
finaldatav1 <- finaldata[,c(-2,-7,-31,-33,-35,-37)]
write.csv(finaldatav1,"finaldatav1.csv",row.names = F)
finaldatav2 <- merge(finaldatav1,IRIdates_months_seasons,by=("IRIweek"))
finaldatav3 <- finaldatav2
write.csv(finaldatav3,"finaldatav3.csv",row.names = F)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeSM==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Small")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeMD==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Medium")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeLR==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "Large")
barplot(prop.table(table(finaldatav2$IRIweek[finaldatav2$sizeXL==1 & finaldatav2$Season=="summer"])),ylim=c(0,0.1), main = "X-Large")
par(mfrow=c(1,1))
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange")
barplot(prop.table(table(finaldata$brand[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown")
par(mfrow=c(1,1))
table(finaldatav2$Season,finaldata$brand)
par(mfrow=c(3,4))
for (i in 1:12) {
barplot(prop.table(table(finaldata$brand[finaldatav2$Month==i])), main=i, xlab = "Brand")
}
par(mfrow=c(1,1))
table(finaldatav3$Season,finaldatav3$size)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.8))
par(mfrow=c(1,1))
table(finaldatav3$Season,finaldatav3$size)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.8))
barplot(prop.table(table(finaldata$size[finaldatav2$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.8))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
hist(finaldatav3$price_cut[finaldatav3$Season=="winter"], ylim = c(0,1500), main="Winter", xlab = "Price Cut", col = "Light Blue")
hist(finaldatav3$price_cut[finaldatav3$Season=="spring"], ylim = c(0,1500), main="Spring", xlab = "Price Cut", col = "light green")
hist(finaldatav3$price_cut[finaldatav3$Season=="summer"], ylim = c(0,1500),main="Summer", xlab = "Price Cut", col = "orange")
hist(finaldatav3$price_cut[finaldatav3$Season=="autumn"], ylim = c(0,1500), main="Autumn", xlab = "Price Cut", col = "brown")
par(mfrow=c(1,1))
table(finaldatav3$Season,finaldatav3$`SKU#`)
par(mfrow=c(2,2))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="winter"])), main="Winter", xlab = "Brand", col = "Light Blue", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="spring"])), main="Spring", xlab = "Brand", col = "light green", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="summer"])), main="Summer", xlab = "Brand", col = "orange", ylim = c(0,0.1))
barplot(prop.table(table(finaldatav3$`SKU#`[finaldatav3$Season=="autumn"])), main="Autumn", xlab = "Brand", col = "brown", ylim = c(0,0.1))
par(mfrow=c(1,1))
plot(finaldatav3$`SKU#`,finaldatav3$ARSP, col = finaldatav3$size, pch =19, las=2)
plot(finaldatav3$`SKU#`,finaldatav3$ARSP, col = finaldatav3$size, pch =19)
barplot(prop.table(table(finaldatav3$Month)))
barplot(prop.table(table(finaldatav3$Season)))
View(finaldatav3)
